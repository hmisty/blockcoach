---
layout: post
title: "谈谈区块链系统的停机问题"
date: 2021-09-15 08:00:00 +0800
categories: essay
---

隔夜比特币重新站上47k，以太坊也回到了3400，传言中的利空没有兑现，市场就丧失了警惕心，避险资金开始回流，推动了一个不小的涨幅。距9/7刚刚过去一周多，这一波调整就要草草了事了吗？也许并不能高兴的过早。

从各项数据来看，NFT的狂热季的确是开始凉凉了。无论是交易平台的成交量，还是主要IP的地板价，亦或者是新IP推出的速度，因为导致以太坊链上拥堵的程度和gas费，都出现了明显的、断崖式的下跌乃至于腰斩。不过，gas减少导致以太坊燃烧减缓，从而导致增发加速，并进一步使得二级市场承压的情形，目前暂时还没有出现。也许这样的死亡螺旋，我们难以在牛市中的回调里看到，而要等到真正的熊市降临才得以目睹吗？

昨天甚是奇怪。竞争链Solana宕机了，好几个小时无法出块。作为一个Layer-1区块链主链居然可以交易过载直接崩坏掉，这是有严重问题的。工程技术是有严格约束的，在性能和安全、可靠之间，总有一个取舍。

互联网高可用系统设计原理告诉我们，在必须分布式的情况下，一致性（决定了共识形成的速度）和可用性就是跷跷板的两头，按下葫芦浮起瓢。对区块链系统而言，可用性涵盖着安全性，或者被安全性涵盖。因为如果系统都可以停止工作，那么所谓的资产安全、资金安全、交易保障就成了一个笑话。比特币和以太坊的技术架构，显然是巧妙而适当地舍弃了前者而追求了后者。

说来也巧，昨晚，近期走红的以太坊二层网络Arbitrum也停机了，原因不明。当然，它作为Layer-2，已经把资产的安全性托付给了Layer-1也就是以太坊，所以理论上讲，它的设计初衷就是更加侧重于性能而不是可用性，因而允许一定的停机时间。不过，哪怕是作为一个互联网级别的服务，也应该加强高可用性的建设。

世界最大的互联网公司之一，谷歌（Google）的全球分布式数据库Spanner的数据节点部署在遍布全球六个大洲、几十个机房的成千上万台服务器上，具有5个9的高可用性（即在99.999%的时间可用）。测试数据表明，仅14个节点的Spanner性能便可达到约15万TPS（每秒事务数）、每秒钟135兆字节数据吞吐量、平均延迟仅1.2毫秒。而全球的Spanner服务器，都由谷歌公司进行协调、维护和控制。

时至今日，比特币网络中可探明的全节点已遍布全球六个大洲、上百个国家、上万台机器，而且这些机器分别是由非常多互不相识、无统一指挥的人各自独立运行和维护的。据统计，十几年来，比特币网络的实际可用性高达99.985%（早年在中本聪时代曾有过极短暂的停网维护），足以比肩世界顶级互联网服务商。

99.999%的可用性或者可靠性又被形象地称为“5个9”。“5个9”是什么概念呢？就是统计平均每年停机时间或服务不可用的时间不能超过5分钟。像Solana这次一下停了3个多小时，那么接下来它需要连续不间断运行40年左右才能把这段宕机事故的时间消化到5个9的水平。

普通的互联网服务多数也就是是“3个9”即99.9%的可用性。这个标准就宽松的多了，意味着一年可以允许有长达500分钟，也就是大约8个多小时的停机维护或故障维修的时间。

至于以太坊，我没有看到统计数字。不过我想，当年TheDAO事件导致以太坊硬分叉，整个分叉回滚的时间，应该都算作服务不可用时间吧。如此算来，以太坊的实际可用性记录，应该是远远低于“5个9”的水平的，但这是历史问题造成的，今天的以太坊，稳定性、可用性还是可以的了。

(公众号：刘教链)
(免责声明：本文内容均不构成任何投资建议。加密货币为极高风险品种，有随时归零的风险，请谨慎参与，自我负责。)
